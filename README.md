# PXE + Ansible 기반 Kubernetes 자동화 인프라 프로젝트

## 1. 프로젝트 개요

본 프로젝트는 반복적인 서버 재구성 환경에서 발생하는
운영체제 설치 및 Kubernetes 클러스터 구축의 수작업 의존 문제를 해결하기 위해
PXE 기반 OS 자동 설치와 Ansible 기반 설정 자동화를 결합하여
멀티 노드 Kubernetes 클러스터를 표준화된 방식으로 구축하는 것을 목표로 한다.

단순 클러스터 구축이 아닌,
운영 재현성, 형상 관리, 확장성을 고려한
운영형 인프라 자동화 구조를 설계하였다.

---

## 2. 전체 자동화 범위

본 프로젝트의 자동화 범위는 다음과 같다.

- PXE + Kickstart 기반 OS 자동 설치
- 서버 초기 설정 자동화 (패키지, 커널 설정, 네트워크 설정 등)
- Control Plane 노드 구성 자동화
- Worker 노드 Join 자동화
- Storage 노드 구성
- Git 기반 인프라 형상 관리
- 모니터링 및 관측 체계 확장 구조 포함

즉, 서버 전원 인가 이후 OS 프로비저닝부터
Kubernetes 멀티 노드 클러스터 구성까지를 자동화 범위로 정의하였다.

---

## 3. 아키텍처 구성

### 구성 노드

| 서버 유형 | 역할 |
|------------|--------|
| PXE 서버 | 네트워크 부팅 및 OS 자동 설치 |
| Ansible 관리 서버 | 설정 자동화 및 클러스터 구성 |
| Control Plane 노드 | 클러스터 제어 및 스케줄링 |
| Worker 노드 | 워크로드 실행 |
| Storage 노드 | 클러스터 스토리지 제공 |

---

## 4. 자동화 설계 특징

### 1) 단계별 플레이북 분리 구조

- 01-setting : 기본 시스템 설정
- 02-k8s-control : Control Plane 구성
- 03-k8s-compute : Worker 노드 구성
- 04-storage : 스토리지 노드 설정

역할 기반 분리를 통해 유지보수성과 재사용성을 확보하였다.

---

### 2) Kubernetes 구성 자동화 구조

- `kubernetes.repo.j2`, `cri-o.repo.j2` 템플릿을 통한 저장소 설정 자동화
- kubelet, kubeadm, CRI-O 패키지 자동 설치 및 서비스 활성화
- `kubeadm-config.j2` 기반 Control Plane 초기화 자동화
- `kubeadm-join.j2` 기반 Worker 노드 Join 자동화
- inventory 기반 노드 역할 분리 적용
- vars.yaml을 통한 버전 및 네트워크 변수 관리

모든 구성은 템플릿 및 변수 기반으로 설계되어
수동 명령 실행 없이 일관된 방식으로 클러스터가 구성된다.

---

## 5. 디렉토리 구조
01-setting/        # 기본 시스템 설정
02-k8s-control/    # Control Plane 구성
03-k8s-compute/    # Worker 구성
04-storage/        # Storage 구성
inventory/         # 노드 정의 및 변수 파일
ansible-start.sh   # Ansible 실행 스크립트
pxe-start.sh       # PXE 실행 스크립트

플레이북과 템플릿을 단계별로 분리하여
구성 변경 시 특정 영역만 수정 가능하도록 설계하였다.

---

## 6. Git 기반 인프라 관리 전략

모든 Ansible 플레이북과 설정 파일은 GitLab을 통해 관리한다.

- 변경 이력 추적
- 버전 관리
- 설정 롤백 가능
- 협업 기반 인프라 관리

인프라 구성 자체를 코드로 관리하는 IaC 구조를 적용하였다.

---

## 7. 관측(Observability) 확장 설계

클러스터 운영 안정성을 위해
모니터링 및 관측 체계를 포함하도록 설계하였다.

- Prometheus 기반 메트릭 수집
- Grafana 기반 대시보드 시각화
- 향후 Alertmanager 연동 가능

구축 중심이 아닌 운영 확장성을 고려한 인프라 구조이다.

---

## 8. 프로젝트 의의

본 프로젝트는 단순 Kubernetes 설치 실습이 아닌,

- OS 프로비저닝 자동화
- 설정 자동화
- 클러스터 구성 자동화
- Storage 구성
- Git 기반 형상 관리
- 운영 관측 확장 설계

까지 포함한 운영형 Kubernetes 자동화 인프라 모델을 구현하는 것을 목표로 한다.

즉, 반복적인 서버 재구성 환경에서도
표준화된 방식으로 동일한 클러스터를 재현할 수 있는
자동화 기반 인프라 구조를 설계·구현한 프로젝트이다.
